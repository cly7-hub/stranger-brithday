<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæ—¥å¿«ä¹ ğŸ‚âœ¨</title>
    <style>
        :root {
            --primary-pink: #ff00ff;
            --primary-purple: #8b00ff;
            --primary-cyan: #00ffff;
            --neon-pink: #ff1493;
            --neon-purple: #9d4edd;
            --neon-cyan: #00d9ff;
            --gradient-1: linear-gradient(135deg, #ff00ff 0%, #8b00ff 50%, #00ffff 100%);
            --gradient-2: linear-gradient(135deg, #ff1493 0%, #9d4edd 50%, #00d9ff 100%);
            --gradient-3: linear-gradient(135deg, #ff6b9d 0%, #c44569 50%, #f8b500 100%);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
        }

        [data-theme="dark"] {
            --glass-bg: rgba(0, 0, 0, 0.3);
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            height: 100%;
            overflow-x: hidden;
            overscroll-behavior-y: none;
            -webkit-overflow-scrolling: touch;
            width: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: var(--gradient-1);
            background-size: 400% 400%;
            min-height: 100vh;
            min-height: -webkit-fill-available;
            overflow-x: hidden;
            overflow-y: auto;
            color: #fff;
            transition: background 0.3s;
            overscroll-behavior-y: none;
            -webkit-overflow-scrolling: touch;
            position: relative;
        }

        /* æ¡Œé¢ç«¯å¯ç”¨èƒŒæ™¯åŠ¨ç”» */
        @media (min-width: 769px) {
            body {
                animation: gradientShift 15s ease infinite;
            }
        }

        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* éª¨æ¶å± */
        .skeleton {
            background: linear-gradient(90deg, rgba(255,255,255,0.1) 25%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.1) 75%);
            background-size: 200% 100%;
            animation: skeleton-loading 1.5s ease-in-out infinite;
        }

        @keyframes skeleton-loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* åŠ è½½é¡µ - éª¨æ¶å±é£æ ¼ */
        #loading {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--gradient-1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.3s;
        }

        #loading.hide {
            opacity: 0;
            pointer-events: none;
        }

        .loading-cake {
            width: 80px;
            height: 80px;
            font-size: 60px;
            animation: bounceRotate 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            filter: drop-shadow(0 0 20px rgba(255, 0, 255, 0.8));
        }

        @keyframes bounceRotate {
            0%, 100% { transform: rotate(0deg) scale(1) translateY(0); }
            25% { transform: rotate(90deg) scale(1.2) translateY(-10px); }
            50% { transform: rotate(180deg) scale(1) translateY(0); }
            75% { transform: rotate(270deg) scale(1.2) translateY(-10px); }
        }

        .loading-text {
            margin-top: 20px;
            font-size: 18px;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }

        /* ä¸»é¢˜åˆ‡æ¢æŒ‰é’® */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            padding: 10px 20px;
            cursor: pointer;
            color: #fff;
            font-size: 14px;
            transition: all 0.25s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .theme-toggle:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.6);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        /* é¦–å±è§†è§‰åŒº - éœ“è™¹å…‰æ•ˆ */
        .hero-section {
            min-height: 100vh;
            min-height: -webkit-fill-available;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            padding: 20px;
            overflow: hidden;
        }

        /* æµä½“æ¸å˜èƒŒæ™¯ */
        .fluid-bg {
            position: absolute;
            width: 200%;
            height: 200%;
            top: -50%;
            left: -50%;
            background: radial-gradient(circle, rgba(255, 0, 255, 0.3) 0%, rgba(139, 0, 255, 0.2) 30%, rgba(0, 255, 255, 0.2) 60%, transparent 100%);
            filter: blur(60px);
            will-change: transform;
            contain: layout style paint;
        }

        /* æ¡Œé¢ç«¯å¯ç”¨æµä½“åŠ¨ç”» */
        @media (min-width: 769px) {
            .fluid-bg {
                animation: fluidMove 20s ease-in-out infinite;
            }
        }

        @keyframes fluidMove {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            33% { transform: translate(30%, 30%) rotate(120deg); }
            66% { transform: translate(-30%, 30%) rotate(240deg); }
        }

        .floating-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            overflow: hidden;
        }

        .star, .confetti {
            position: absolute;
            font-size: 24px;
            filter: drop-shadow(0 0 10px currentColor);
            will-change: transform, opacity;
            contain: layout style paint;
        }

        /* ç§»åŠ¨ç«¯å‡å°‘åŠ¨ç”»é¢‘ç‡ */
        @media (max-width: 768px) {
            .star, .confetti {
                animation: floatGlow 6s ease-in-out infinite;
            }
        }

        @media (min-width: 769px) {
            .star, .confetti {
                animation: floatGlow 3s ease-in-out infinite;
            }
        }

        .confetti.large {
            font-size: 32px;
        }

        @keyframes floatGlow {
            0%, 100% { 
                transform: translate3d(0, 0, 0) scale(1);
                opacity: 0.8;
            }
            50% { 
                transform: translate3d(15px, -30px, 0) scale(1.2);
                opacity: 1;
            }
        }

        /* éœ“è™¹æ ‡é¢˜ */
        .main-title {
            font-size: clamp(32px, 8vw, 64px);
            text-align: center;
            margin-bottom: 20px;
            background: var(--gradient-2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
            letter-spacing: 4px;
            text-shadow: 
                0 0 10px #ffb3d9,
                0 0 20px #ff99cc,
                0 0 30px #ff80b3,
                0 0 40px rgba(139, 0, 255, 0.6),
                0 0 60px rgba(0, 255, 255, 0.4);
            animation: neonPulse 2s ease-in-out infinite;
            position: relative;
            z-index: 10;
        }

        /* EmojiåŠ¨æ€ç»„åˆ */
        .emoji-flow {
            display: inline-block;
            animation: flow 3s linear infinite;
            margin-left: 10px;
        }

        @keyframes flow {
            0% { transform: translateX(0) scale(1); }
            25% { transform: translateX(10px) scale(1.2); }
            50% { transform: translateX(0) scale(1); }
            75% { transform: translateX(-10px) scale(1.2); }
            100% { transform: translateX(0) scale(1); }
        }

        @keyframes neonPulse {
            0%, 100% { 
                filter: drop-shadow(0 0 20px rgba(255, 0, 255, 0.8));
            }
            50% { 
                filter: drop-shadow(0 0 40px rgba(255, 0, 255, 1));
            }
        }

        /* ç§»åŠ¨ç«¯ç®€åŒ–éœ“è™¹æ•ˆæœ */
        @media (max-width: 768px) {
            .main-title {
                animation: none;
                filter: drop-shadow(0 0 20px rgba(255, 0, 255, 0.8));
            }
        }

        /* æ—¥æœŸæ˜¾ç¤º - ç»ç’ƒæ‹Ÿæ€ */
        .date-display {
            font-size: clamp(18px, 4vw, 28px);
            text-align: center;
            margin-top: 30px;
            padding: 15px 30px;
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid var(--glass-border);
            border-radius: 30px;
            display: inline-block;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: dateFloat 3s ease-in-out infinite;
            position: relative;
            z-index: 10;
            will-change: transform;
        }

        @keyframes dateFloat {
            0%, 100% { transform: translate3d(0, 0, 0) scale(1); }
            50% { transform: translate3d(0, -10px, 0) scale(1.05); }
        }

        /* ç§»åŠ¨ç«¯æš‚åœæ—¥æœŸæµ®åŠ¨åŠ¨ç”» */
        @media (max-width: 768px) {
            .date-display {
                animation: none;
            }
        }

        /* çƒŸèŠ±ç‰¹æ•ˆå¢å¼º */
        .fireworks-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
            overflow: hidden;
        }

        /* ä¸Šå‡çš„çƒŸèŠ±å¼¹ */
        .firework-rocket {
            position: absolute;
            width: 6px;
            height: 20px;
            background: linear-gradient(to top, var(--rocket-color) 0%, rgba(255, 255, 255, 0.8) 100%);
            border-radius: 3px;
            box-shadow: 
                0 0 10px var(--rocket-color),
                0 0 20px var(--rocket-color);
            animation: rocketRise var(--rise-duration) cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            will-change: transform, opacity;
            contain: layout style paint;
        }

        @keyframes rocketRise {
            0% {
                opacity: 1;
                transform: translateY(0) scaleY(1);
            }
            50% {
                opacity: 1;
                transform: translateY(calc(var(--target-y) * -1px)) scaleY(1);
            }
            100% {
                opacity: 0;
                transform: translateY(calc(var(--target-y) * -1px)) scaleY(0.5);
            }
        }

        /* ä¸Šå‡è½¨è¿¹çš„å°¾è¿¹ */
        .firework-trail {
            position: absolute;
            width: 3px;
            height: 30px;
            background: linear-gradient(to top, var(--trail-color) 0%, transparent 100%);
            border-radius: 50%;
            opacity: 0.6;
            animation: trailFade var(--rise-duration) linear forwards;
        }

        @keyframes trailFade {
            0% {
                opacity: 0.8;
                transform: translateY(0) scaleY(1);
            }
            100% {
                opacity: 0;
                transform: translateY(calc(var(--target-y) * -1px)) scaleY(0.3);
            }
        }

        /* çˆ†ç‚¸ä¸­å¿ƒ */
        .firework {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: radial-gradient(circle, #fff 0%, var(--firework-color) 100%);
            box-shadow: 
                0 0 20px var(--firework-color),
                0 0 40px var(--firework-color),
                0 0 60px var(--firework-color);
            animation: fireworkExplode 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) forwards;
        }

        @keyframes fireworkExplode {
            0% { opacity: 1; transform: scale(1); }
            50% { opacity: 1; transform: scale(2); }
            100% { opacity: 0; transform: scale(0); }
        }

        /* çˆ†ç‚¸ç²’å­ */
        .firework-particle {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, #fff 0%, var(--particle-color) 50%, transparent 100%);
            box-shadow: 
                0 0 10px var(--particle-color),
                0 0 20px var(--particle-color);
            animation: particleFly 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            will-change: transform, opacity;
            contain: layout style paint;
        }

        @keyframes particleFly {
            0% {
                opacity: 1;
                transform: translate(0, 0) scale(1) rotate(0deg);
            }
            100% {
                opacity: 0;
                transform: translate(var(--dx), var(--dy)) scale(0) rotate(var(--rotation));
            }
        }

        /* ç¥ç¦åŒº - ç»ç’ƒæ‹Ÿæ€è¿›é˜¶ */
        .blessing-section {
            padding: 30px;
            text-align: center;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            margin: 40px 20px;
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 8px 32px rgba(31, 38, 135, 0.05),
                0 0 0 1px rgba(255, 255, 255, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2),
                0 0 30px rgba(255, 0, 255, 0.1);
            position: relative;
            overflow: hidden;
            opacity: 0;
            transform: translate3d(0, 30px, 0);
            transition: opacity 0.6s ease, transform 0.6s ease;
            will-change: transform, opacity;
        }

        .blessing-section.visible {
            opacity: 1;
            transform: translate3d(0, 0, 0);
        }

        .blessing-section::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: var(--gradient-2);
            opacity: 0.1;
            animation: rotate 20s linear infinite;
            z-index: -1;
        }

        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .blessing-text {
            font-size: clamp(20px, 5vw, 28px);
            color: #fff;
            line-height: 1.8;
            letter-spacing: 1px;
            min-height: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0;
            padding: 25px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            position: relative;
            z-index: 1;
        }

        /* æŒ‰é’® - å¼¹è·³+è‰²å½©çˆ†ç ´ */
        .blessing-btn, .birthday-card-btn, .wall-input button {
            background: var(--gradient-2);
            border: none;
            padding: 15px 35px;
            min-height: 44px;
            min-width: 44px;
            border-radius: 50px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            touch-action: manipulation;
            transition: transform 0.2s, opacity 0.2s;
            box-shadow: 
                0 4px 15px rgba(255, 0, 255, 0.4),
                0 0 20px rgba(139, 0, 255, 0.3);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 1px;
            will-change: transform;
        }

        .blessing-btn::before, .birthday-card-btn::before, .wall-input button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .blessing-btn:active::before, .birthday-card-btn:active::before, 
        .wall-input button:active::before {
            width: 300px;
            height: 300px;
        }

        @media (hover: hover) and (pointer: fine) {
            .blessing-btn:hover, .birthday-card-btn:hover, .wall-input button:hover {
                transform: scale(1.1) translateY(-2px);
                box-shadow: 
                    0 6px 25px rgba(255, 0, 255, 0.6),
                    0 0 40px rgba(139, 0, 255, 0.5);
            }
        }

        .blessing-btn:active, .birthday-card-btn:active, .wall-input button:active {
            transform: scale(0.95) translateY(0);
            animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes pop {
            0% { box-shadow: 0 0 0 0 rgba(255, 179, 217, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(255, 179, 217, 0); }
            100% { box-shadow: 0 0 0 0 rgba(255, 179, 217, 0); }
        }

        /* è¾“å…¥æ¡† - è„‰å†²åŠ¨ç”» */
        .wall-input input, #wallInput {
            flex: 1;
            padding: 15px 20px;
            min-height: 50px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            color: #fff;
            transition: transform 0.2s, opacity 0.2s, box-shadow 0.2s;
            will-change: transform, opacity;
        }

        .wall-input input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .wall-input input:focus {
            border-color: var(--neon-pink);
            box-shadow: 
                0 0 20px rgba(255, 20, 147, 0.6),
                0 0 40px rgba(255, 20, 147, 0.4),
                inset 0 0 20px rgba(255, 20, 147, 0.1);
            animation: pulseFocus 1.5s ease-in-out infinite;
        }

        @keyframes pulseFocus {
            0%, 100% { box-shadow: 0 0 20px rgba(255, 20, 147, 0.6), 0 0 40px rgba(255, 20, 147, 0.4), inset 0 0 20px rgba(255, 20, 147, 0.1); }
            50% { box-shadow: 0 0 30px rgba(255, 20, 147, 0.8), 0 0 60px rgba(255, 20, 147, 0.6), inset 0 0 30px rgba(255, 20, 147, 0.2); }
        }

        /* éŸ³ä¹æ§åˆ¶ + å¯è§†åŒ– */
        .music-control {
            margin-top: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            color: #fff;
            transition: all 0.25s;
            position: relative;
        }

        .music-control:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.4);
        }

        .music-visualizer {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 200px;
            height: 60px;
            display: none;
            gap: 4px;
            align-items: flex-end;
            z-index: 100;
        }

        .music-visualizer.active {
            display: flex;
        }

        .visualizer-bar {
            flex: 1;
            background: var(--gradient-2);
            border-radius: 2px 2px 0 0;
            animation: visualizerPulse 0.5s ease-in-out infinite;
            box-shadow: 0 0 10px rgba(255, 0, 255, 0.6);
        }

        .visualizer-bar:nth-child(1) { animation-delay: 0s; }
        .visualizer-bar:nth-child(2) { animation-delay: 0.1s; }
        .visualizer-bar:nth-child(3) { animation-delay: 0.2s; }
        .visualizer-bar:nth-child(4) { animation-delay: 0.3s; }
        .visualizer-bar:nth-child(5) { animation-delay: 0.4s; }

        @keyframes visualizerPulse {
            0%, 100% { height: 20%; }
            50% { height: 100%; }
        }

        /* äº’åŠ¨åŒº */
        .interactive-section {
            padding: 40px 20px;
            text-align: center;
            margin: 40px 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-radius: 30px;
            border: 1px solid var(--glass-border);
            opacity: 0;
            transform: translate3d(0, 30px, 0);
            transition: opacity 0.6s ease, transform 0.6s ease;
            will-change: transform, opacity;
        }

        .interactive-section.visible {
            opacity: 1;
            transform: translate3d(0, 0, 0);
        }

        .candle-container {
            margin: 40px 0;
        }

        .candle {
            width: 50px;
            height: 140px;
            background: linear-gradient(to bottom, #fff 0%, #ffe6f0 100%);
            border-radius: 25px 25px 0 0;
            margin: 0 auto;
            position: relative;
            box-shadow: 
                0 4px 15px rgba(0, 0, 0, 0.2),
                inset 0 0 20px rgba(255, 255, 255, 0.3);
        }

        .flame {
            width: 25px;
            height: 35px;
            background: radial-gradient(ellipse, #ffd93d 0%, #ffa500 40%, #ff6b6b 80%, #ff4757 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            animation: flicker 0.4s ease-in-out infinite alternate;
            cursor: pointer;
            box-shadow: 
                0 0 20px rgba(255, 215, 61, 0.8),
                0 0 40px rgba(255, 107, 107, 0.6);
            filter: drop-shadow(0 0 10px rgba(255, 215, 61, 0.8));
        }

        @keyframes flicker {
            0% { transform: translateX(-50%) scale(1) rotate(-3deg); }
            100% { transform: translateX(-50%) scale(1.15) rotate(3deg); }
        }

        .flame.blown {
            animation: blowOut 0.8s forwards;
        }

        @keyframes blowOut {
            0% { transform: translateX(-50%) scale(1) rotate(0deg); opacity: 1; }
            30% { transform: translateX(-50%) scale(1.5) rotate(10deg); opacity: 0.8; }
            60% { transform: translateX(-50%) scale(0.5) rotate(-5deg); opacity: 0.4; }
            100% { transform: translateX(-50%) scale(0) rotate(0deg); opacity: 0; }
        }

        .particles {
            position: absolute;
            top: -30px;
            left: 50%;
            width: 150px;
            height: 150px;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            animation: particleFloat 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
            background: radial-gradient(circle, var(--particle-color-light) 0%, var(--particle-color) 100%);
            box-shadow: 0 0 10px var(--particle-color);
            will-change: transform, opacity;
        }

        @keyframes particleFloat {
            0% { opacity: 1; transform: translate(0, 0) scale(1) rotate(0deg); }
            100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0) rotate(var(--rotation)); }
        }

        /* ç”Ÿæ—¥ç­¾ */
        .card-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .card-modal.show {
            display: flex;
        }

        .card-content {
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid var(--glass-border);
            padding: 50px;
            border-radius: 30px;
            max-width: 90vw;
            width: 450px;
            text-align: center;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: cardAppear 0.2s ease-out;
            position: relative;
            will-change: transform, opacity;
        }

        @keyframes cardAppear {
            0% { transform: scale(0.95); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .card-text {
            font-size: 24px;
            color: #fff;
            margin: 20px 0;
            line-height: 1.8;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .close-card {
            background: var(--gradient-2);
            border: none;
            padding: 12px 30px;
            min-height: 50px;
            min-width: 50px;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            margin-top: 25px;
            transition: transform 0.2s;
            font-weight: 600;
            touch-action: manipulation;
        }

        .close-card:hover {
            transform: scale(1.1) rotate(5deg);
        }

        /* ç¥ç¦å¢™å‡çº§ */
        .wall-section {
            padding: 30px;
            margin: 40px 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-radius: 30px;
            border: 1px solid var(--glass-border);
            position: relative;
            opacity: 0;
            transform: translate3d(0, 30px, 0);
            transition: opacity 0.6s ease, transform 0.6s ease;
            will-change: transform, opacity;
        }

        .wall-section.visible {
            opacity: 1;
            transform: translate3d(0, 0, 0);
        }

        .wall-title {
            text-align: center;
            font-size: clamp(24px, 5vw, 32px);
            color: #fff;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(255, 0, 255, 0.6);
        }

        .wall-stats {
            text-align: center;
            color: rgba(255, 255, 255, 0.8);
            margin-bottom: 20px;
            font-size: 14px;
        }

        .wall-messages {
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 30px;
            padding: 20px;
            scrollbar-width: thin;
            scrollbar-color: rgba(255, 0, 255, 0.6) transparent;
            -webkit-overflow-scrolling: touch;
            overscroll-behavior: contain;
            overscroll-behavior-y: contain;
        }

        .wall-messages::-webkit-scrollbar {
            width: 8px;
        }

        .wall-messages::-webkit-scrollbar-thumb {
            background: var(--gradient-2);
            border-radius: 4px;
        }

        .wall-message {
            padding: 20px;
            margin: 15px 0;
            background: var(--glass-bg);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border-radius: 15px;
            border: 1px solid var(--glass-border);
            animation: slideInFromRight 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            color: #fff;
            line-height: 1.8;
            position: relative;
            will-change: transform, opacity;
        }

        @keyframes slideInFromRight {
            from { opacity: 0; transform: translate3d(50px, 0, 0) scale(0.9); }
            to { opacity: 1; transform: translate3d(0, 0, 0) scale(1); }
        }

        .wall-message-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            align-items: center;
        }

        .like-btn, .reply-btn {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 5px 12px;
            border-radius: 15px;
            color: #fff;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }

        .like-btn:hover, .reply-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.05);
        }

        .like-btn.liked {
            background: var(--gradient-2);
            border-color: transparent;
            animation: heartBeat 0.5s;
        }

        @keyframes heartBeat {
            0% { transform: scale(1); }
            25% { transform: scale(1.3); }
            50% { transform: scale(1.5); }
            75% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .like-count {
            margin-left: 5px;
            font-size: 12px;
        }

        .wall-input {
            display: flex;
            gap: 10px;
            max-width: 600px;
            margin: 0 auto;
        }

        .wall-input button {
            padding: 15px 30px;
        }

        /* ç²’å­æ‹–å°¾æ•ˆæœ */
        .trail-particle {
            position: fixed;
            pointer-events: none;
            font-size: 20px;
            z-index: 9999;
            animation: trailFade 0.8s ease-out forwards;
            transform: translate(-50%, -50%);
        }

        @keyframes trailFade {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5) translateY(-20px);
            }
        }

        .share-btn {
            margin: 5px;
        }

        /* åº•éƒ¨ */
        .footer-section {
            padding: 50px 20px;
            text-align: center;
        }

        .footer-text {
            font-size: clamp(20px, 5vw, 28px);
            color: #fff;
            line-height: 1.8;
            margin-bottom: 30px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .back-to-top {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            color: #fff;
            font-size: 14px;
            opacity: 0;
            transform: translateY(20px);
            pointer-events: none;
            transition: all 0.3s;
        }

        .back-to-top.show {
            opacity: 1;
            transform: translateY(0);
            pointer-events: auto;
        }

        .back-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.4);
        }

        /* éšè—ç‰¹æ•ˆæç¤º */
        .easter-egg-hint {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            z-index: 100;
            animation: fadeInOut 3s ease-in-out infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* å“åº”å¼ */
        @media (max-width: 768px) {
            .main-title {
                font-size: clamp(28px, 8vw, 48px);
            }
            
            .blessing-text {
                min-height: 120px;
                font-size: 18px;
            }
            
            .wall-input {
                flex-direction: column;
            }

            .blessing-section, .wall-section, .interactive-section {
                margin: 20px 10px;
                padding: 20px;
            }
        }

        /* æ¨ªå±é€‚é… */
        @media (orientation: landscape) and (max-height: 500px) {
            .floating-elements {
                display: none;
            }

            .blessing-section, .wall-section, .interactive-section {
                margin: 20px 10px;
            }
        }

        /* æ·±è‰²æ¨¡å¼ */
        [data-theme="dark"] body {
            background: linear-gradient(135deg, #1a0033 0%, #330066 50%, #003366 100%);
        }
    </style>
</head>
<body>
    <!-- åŠ è½½é¡µ -->
    <div id="loading">
        <div class="loading-cake">ğŸ‚</div>
        <div class="loading-text">ç”Ÿæ—¥æƒŠå–œåŠ è½½ä¸­âœ¨</div>
    </div>

    <!-- ä¸»é¢˜åˆ‡æ¢ -->
    <button class="theme-toggle" id="themeToggle">ğŸŒ™ æ·±è‰²æ¨¡å¼</button>

    <!-- çƒŸèŠ±ç‰¹æ•ˆå®¹å™¨ -->
    <div class="fireworks-container" id="fireworksContainer"></div>

    <!-- æµä½“èƒŒæ™¯ -->
    <div class="fluid-bg"></div>

    <!-- é¦–å±è§†è§‰åŒº -->
    <section class="hero-section">
        <div class="floating-elements" id="floatingElements"></div>
        <h1 class="main-title">äº²çˆ±çš„ä½ ï¼Œç”Ÿæ—¥å¿«ä¹ï¼<span class="emoji-flow">ğŸ‚ğŸ‰âœ¨</span></h1>
        <div class="date-display" id="dateDisplay">æ­£åœ¨åŠ è½½æ—¥æœŸ...</div>
    </section>

    <!-- ç¥ç¦åŒº -->
    <section class="blessing-section">
        <div class="blessing-text" id="blessingText">æ­£åœ¨åŠ è½½ç¥ç¦...</div>
        <button class="blessing-btn" id="changeBlessingBtn">ç‚¹å‡»æ¢ä¸€å¥ç¥ç¦ ğŸ’«</button>
        <button class="music-control" id="musicControl">ğŸµ èƒŒæ™¯éŸ³ä¹</button>
    </section>

    <!-- éŸ³ä¹å¯è§†åŒ– -->
    <div class="music-visualizer" id="musicVisualizer">
        <div class="visualizer-bar"></div>
        <div class="visualizer-bar"></div>
        <div class="visualizer-bar"></div>
        <div class="visualizer-bar"></div>
        <div class="visualizer-bar"></div>
    </div>

    <!-- äº’åŠ¨åŒº -->
    <section class="interactive-section">
        <h2 style="color: #fff; margin-bottom: 30px; font-size: clamp(24px, 5vw, 32px); text-shadow: 0 0 20px rgba(255, 0, 255, 0.6);">äº’åŠ¨å°å½©è›‹ ğŸ</h2>
        <div class="candle-container">
            <div class="candle" id="candle">
                <div class="flame" id="flame"></div>
                <div class="particles" id="particles"></div>
            </div>
            <p style="margin-top: 20px; color: rgba(255, 255, 255, 0.9); font-size: 14px;">ç‚¹å‡»èœ¡çƒ›å¹ç­å®ƒâœ¨</p>
        </div>
        <button class="birthday-card-btn" id="cardBtn">ç”Ÿæˆä¸“å±ç”Ÿæ—¥ç­¾ ğŸ´</button>
    </section>

    <!-- ç”Ÿæ—¥ç­¾å¼¹çª— -->
    <div class="card-modal" id="cardModal">
        <div class="card-content">
            <h3 style="color: #fff; margin-bottom: 25px; font-size: 28px; text-shadow: 0 0 20px rgba(255, 0, 255, 0.6);">ğŸ ä½ çš„ä¸“å±ç”Ÿæ—¥ç­¾</h3>
            <div class="card-text" id="cardText"></div>
            <button class="close-card" id="closeCard">å…³é—­</button>
        </div>
    </div>

    <!-- ç¥ç¦å¢™ -->
    <section class="wall-section">
        <h2 class="wall-title">é™Œç”Ÿäººç¥ç¦å¢™ ğŸ’</h2>
        <div class="wall-stats" id="wallStats">å·²æœ‰ <span id="blessingCount">5</span> æ¡ç¥ç¦</div>
        <div class="wall-messages" id="wallMessages">
            <div class="wall-message">
                <div>ç”Ÿæ—¥å¿«ä¹ï¼Œå¹³å®‰å–œä¹ï½âœ¨</div>
                <div class="wall-message-actions">
                    <button class="like-btn" onclick="toggleLike(this)">â¤ï¸ <span class="like-count"></span></button>
                    <button class="reply-btn">ğŸ’¬ å›å¤</button>
                </div>
            </div>
            <div class="wall-message">
                <div>æ–°å²ï¼Œä¸‡äº‹é¡ºæ„ğŸ‰</div>
                <div class="wall-message-actions">
                    <button class="like-btn" onclick="toggleLike(this)">â¤ï¸ <span class="like-count"></span></button>
                    <button class="reply-btn">ğŸ’¬ å›å¤</button>
                </div>
            </div>
            <div class="wall-message">
                <div>ç”Ÿæ—¥æ„‰å¿«ï¼Œæ—¥æ—¥æ¬¢å–œï½ğŸ’«</div>
                <div class="wall-message-actions">
                    <button class="like-btn" onclick="toggleLike(this)">â¤ï¸ <span class="like-count"></span></button>
                    <button class="reply-btn">ğŸ’¬ å›å¤</button>
                </div>
            </div>
            <div class="wall-message">
                <div>å²å²å¸¸æ¬¢æ„‰ï¼Œå¹´å¹´çš†èƒœæ„ï½ğŸ‚</div>
                <div class="wall-message-actions">
                    <button class="like-btn" onclick="toggleLike(this)">â¤ï¸ <span class="like-count"></span></button>
                    <button class="reply-btn">ğŸ’¬ å›å¤</button>
                </div>
            </div>
            <div class="wall-message">
                <div>æ„¿ä½ ï¼Œç”Ÿæ—¥å¿«ä¹ï¼Œä¸æ­¢ä»Šæ—¥ï½ğŸŒŸ</div>
                <div class="wall-message-actions">
                    <button class="like-btn" onclick="toggleLike(this)">â¤ï¸ <span class="like-count"></span></button>
                    <button class="reply-btn">ğŸ’¬ å›å¤</button>
                </div>
            </div>
        </div>
        <div class="wall-input">
            <input type="text" id="wallInput" placeholder="ç•™ä¸‹ä½ çš„åŒ¿åç¥ç¦ï¼ˆéå¿…å¡«ï¼‰ğŸ’Œ">
            <button id="wallSubmit">å‘é€</button>
        </div>
    </section>

    <!-- åº•éƒ¨ -->
    <section class="footer-section">
        <div class="footer-text">æ„¿ä½ è¢«ä¸–ç•Œæ¸©æŸ”ä»¥å¾…ï¼Œç”Ÿæ—¥å¿«ä¹ğŸ‚âœ¨</div>
        <button class="back-to-top" id="backToTop">è¿”å›é¡¶éƒ¨ â†‘</button>
    </section>

    <!-- å½©è›‹æç¤º -->
    <div class="easter-egg-hint">ğŸ’¡ è¯•è¯•åŒå‡»å±å¹•æˆ–æ‘‡ä¸€æ‘‡æ‰‹æœº</div>

    <script>
        // ç¥ç¦è¯­åº“ - èå…¥ç½‘ç»œçƒ­è¯
        const blessings = [
            "äº²çˆ±çš„ä½ ï¼Œç”Ÿæ—¥å¿«ä¹ğŸ‚ æ„¿æ—¥å­æ¸…é€ï¼Œä¸‡äº‹æ¸©æŸ”ï¼Œæ–°çš„ä¸€å²å°½æ˜¯å¦é€”ï½ç»ç»å­ï¼",
            "ç”Ÿæ—¥å¿«ä¹å‘€ï¼æ„¿ä½ è¢«æ—¶å…‰æ¸©æŸ”ä»¥å¾…ï¼Œæ¯ä¸€å¤©éƒ½æœ‰å°ç¾å¥½ä¸æœŸè€Œé‡ï½æ³°è£¤è¾£ï¼",
            "æ–°çš„ä¸€å²ï¼Œæ„¿ä½ çœ¼é‡Œæœ‰æ˜Ÿå…‰ï¼Œå¿ƒé‡Œæœ‰æ¸©æš–ï¼Œè„šä¸‹æœ‰å¦é€”ï¼Œç”Ÿæ—¥å¿«ä¹ï½å¿«ä¹å€¼æ‹‰æ»¡ï¼",
            "ç¥ä½ ç”Ÿæ—¥å¿«ä¹ï¼ä¸å¿…å…‰èŠ’ä¸‡ä¸ˆï¼Œåªæ±‚æ¸©æš–æœ‰å…‰ï¼Œå²å²å¹´å¹´ï¼Œå¹³å®‰å–œä¹ï½",
            "ç”Ÿæ—¥é™å®šå¿«ä¹âœ¨ æ„¿ä½ æŠŠå¹³å‡¡çš„æ—¥å­è¿‡å¾—çƒ­æ°”è…¾è…¾ï¼Œæ–°å²çš†æœ‰æ¬¢å–œç›¸ä¼´ï½",
            "ç”Ÿæ—¥å¿«ä¹ï¼è§£é”æ–°ä¸€å²çš„ç¾å¥½ï¼Œæ„¿ä½ åƒå¥½å–å¥½ï¼Œå¿«ä¹ä¸å€’ï¼Œä¸‡äº‹çš†é¡ºï½",
            "æ­å–œå‡çº§æ–°å²ğŸˆ æ„¿ä½ æ°¸è¿œå…´è‡´ç›ç„¶ï¼Œæ°¸è¿œç§¯æå‘ä¸Šï¼Œç”Ÿæ—¥å¿«ä¹å‘€ï¼",
            "æ–°çš„365å¤©ï¼Œæ„¿ä½ è„‘æ´å¤§å¼€ï¼Œå¥½è¿å¼€æŒ‚ï¼Œæ‰€æœ‰ç¾å¥½éƒ½å¥”ä½ è€Œæ¥ï¼Œç”Ÿæ—¥å¿«ä¹ï½",
            "ç”Ÿæ—¥å¿«ä¹å‘€ï½æ„¿ä½ åœ¨è‡ªå·±çš„èŠ‚å¥é‡Œï¼Œæ…¢æ…¢èµ°ï¼Œå¥½å¥½çˆ±ï¼Œæ–°å²å°½æ˜¯æ¸©æŸ”ï½",
            "è§£é”äººç”Ÿæ–°ç« èŠ‚ğŸ‚ æ„¿ä½ ä¿æŒçƒ­çˆ±ï¼Œå¥”èµ´å±±æµ·ï¼Œç”Ÿæ—¥å¿«ä¹ï½"
        ];

        // ç”Ÿæ—¥ç­¾æ–‡æ¡ˆåº“ - ä¸ªæ€§åŒ–æ ‡ç­¾
        const cardMessages = [
            "ä»Šæ—¥å¥½è¿MAX âœ¨ èººèµ¢ç‹è€…",
            "æ–°å²ä¸‡äº‹é¡ºæ„ ğŸˆ å¿«ä¹å¹²é¥­äºº",
            "æ„¿ä½ è¢«çˆ±åŒ…è£¹ ğŸ’ å¹¸è¿æ˜Ÿ",
            "ç”Ÿæ—¥å¿«ä¹ï¼Œä¸æ­¢ä»Šæ—¥ ğŸ‚ å…ƒæ°”æ»¡æ»¡",
            "æ–°å²çš†æ˜¯æ¬¢å–œ ğŸŒŸ èƒ½é‡çˆ†è¡¨"
        ];

        // ä¸»é¢˜åˆ‡æ¢
        const themeToggle = document.getElementById('themeToggle');
        let isDark = false;
        themeToggle.addEventListener('click', () => {
            isDark = !isDark;
            document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
            themeToggle.textContent = isDark ? 'â˜€ï¸ æµ…è‰²æ¨¡å¼' : 'ğŸŒ™ æ·±è‰²æ¨¡å¼';
        });

        // çƒŸèŠ±ç‰¹æ•ˆ - ä»åº•éƒ¨å‡èµ·å¹¶çˆ†ç‚¸
        function createFirework(startX, startY, targetX, targetY) {
            // é™åˆ¶åŒæ—¶å­˜åœ¨çš„çƒŸèŠ±æ•°é‡
            if (activeFireworks >= maxActiveFireworks) return;
            activeFireworks++;
            
            const container = document.getElementById('fireworksContainer');
            const colorSchemes = [
                { center: '#ff00ff', particles: ['#ff00ff', '#ff1493', '#ff69b4', '#ffb6c1'], rocket: '#ff00ff', trail: '#ff1493' },
                { center: '#8b00ff', particles: ['#8b00ff', '#9d4edd', '#c77dff', '#e0aaff'], rocket: '#8b00ff', trail: '#9d4edd' },
                { center: '#00ffff', particles: ['#00ffff', '#00d9ff', '#00bfff', '#87ceeb'], rocket: '#00ffff', trail: '#00d9ff' },
                { center: '#ff1493', particles: ['#ff1493', '#ff69b4', '#ffb6c1', '#ffc0cb'], rocket: '#ff1493', trail: '#ff69b4' },
                { center: '#9d4edd', particles: ['#9d4edd', '#c77dff', '#e0aaff', '#f3e5f5'], rocket: '#9d4edd', trail: '#c77dff' }
            ];
            
            const scheme = colorSchemes[Math.floor(Math.random() * colorSchemes.length)];
            const riseDistance = startY - targetY;
            const riseDuration = Math.max(800, Math.min(1500, riseDistance * 2)); // æ ¹æ®è·ç¦»è®¡ç®—ä¸Šå‡æ—¶é—´
            
            // åˆ›å»ºä¸Šå‡çš„çƒŸèŠ±å¼¹
            const rocket = document.createElement('div');
            rocket.className = 'firework-rocket';
            rocket.style.left = startX + 'px';
            rocket.style.top = startY + 'px';
            rocket.style.setProperty('--rocket-color', scheme.rocket);
            rocket.style.setProperty('--target-y', riseDistance);
            rocket.style.setProperty('--rise-duration', riseDuration + 'ms');
            container.appendChild(rocket);
            
            // åˆ›å»ºå°¾è¿¹ - ç§»åŠ¨ç«¯å‡å°‘
            const trailCount = isLowPerformance ? 2 : (window.innerWidth < 768 ? 3 : 5);
            for (let i = 0; i < trailCount; i++) {
                const trail = document.createElement('div');
                trail.className = 'firework-trail';
                trail.style.left = (startX + (Math.random() - 0.5) * 10) + 'px';
                trail.style.top = startY + 'px';
                trail.style.setProperty('--trail-color', scheme.trail);
                trail.style.setProperty('--target-y', riseDistance);
                trail.style.setProperty('--rise-duration', riseDuration + 'ms');
                trail.style.animationDelay = (i * 50) + 'ms';
                container.appendChild(trail);
                setTimeout(() => trail.remove(), riseDuration);
            }
            
            // ä¸Šå‡å®Œæˆåçˆ†ç‚¸ - ç§»åŠ¨ç«¯å‡å°‘ç²’å­æ•°é‡
            setTimeout(() => {
                const particleCount = isLowPerformance ? 15 : (window.innerWidth < 768 ? 25 : 50);
                
                // åˆ›å»ºçˆ†ç‚¸ä¸­å¿ƒ
                const center = document.createElement('div');
                center.className = 'firework';
                center.style.left = targetX + 'px';
                center.style.top = targetY + 'px';
                center.style.setProperty('--firework-color', scheme.center);
                center.style.boxShadow = `0 0 30px ${scheme.center}, 0 0 60px ${scheme.center}`;
                container.appendChild(center);
                
                // åˆ›å»ºçˆ†ç‚¸ç²’å­
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'firework-particle';
                    particle.style.left = targetX + 'px';
                    particle.style.top = targetY + 'px';
                    
                    const color = scheme.particles[Math.floor(Math.random() * scheme.particles.length)];
                    particle.style.setProperty('--particle-color', color);
                    particle.style.width = (4 + Math.random() * 6) + 'px';
                    particle.style.height = particle.style.width;
                    
                    const angle = (Math.PI * 2 * i) / particleCount + (Math.random() - 0.5) * 0.4;
                    const velocity = 100 + Math.random() * 60;
                    const dx = Math.cos(angle) * velocity;
                    const dy = Math.sin(angle) * velocity;
                    const rotation = (Math.random() - 0.5) * 720;
                    
                    particle.style.setProperty('--dx', dx + 'px');
                    particle.style.setProperty('--dy', dy + 'px');
                    particle.style.setProperty('--rotation', rotation + 'deg');
                    
                container.appendChild(particle);
                setTimeout(() => {
                    particle.remove();
                    if (--activeFireworks < 0) activeFireworks = 0;
                }, 1500);
            }
            
            setTimeout(() => {
                center.remove();
                if (--activeFireworks < 0) activeFireworks = 0;
            }, 600);
            setTimeout(() => {
                rocket.remove();
                if (--activeFireworks < 0) activeFireworks = 0;
            }, 100);
        }, riseDuration);
        }

        // æ€§èƒ½æ£€æµ‹å’Œä¼˜åŒ–
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const isLowPerformance = isMobile && (navigator.hardwareConcurrency && navigator.hardwareConcurrency <= 4);
        
        // é™åˆ¶åŒæ—¶å­˜åœ¨çš„çƒŸèŠ±æ•°é‡
        let activeFireworks = 0;
        const maxActiveFireworks = isLowPerformance ? 1 : (window.innerWidth < 768 ? 2 : 5);
        
        function startFireworks() {
            // ç§»åŠ¨ç«¯å¤§å¹…é™ä½é¢‘ç‡å’Œç²’å­æ•°é‡
            const interval = isLowPerformance ? 5000 : (window.innerWidth < 768 ? 3000 : 1500);
            
            setInterval(() => {
                // ä»åº•éƒ¨éšæœºä½ç½®å‡èµ·
                const startX = Math.random() * window.innerWidth;
                const startY = window.innerHeight - 20;
                
                // ç›®æ ‡çˆ†ç‚¸ä½ç½®åœ¨ä¸ŠåŠéƒ¨åˆ†
                const targetX = startX + (Math.random() - 0.5) * 100;
                const targetY = Math.random() * (window.innerHeight * 0.5) + 50;
                
                createFirework(startX, startY, targetX, targetY);
            }, interval);
        }

        // åŠ è½½é¡µ
        window.addEventListener('load', () => {
            setTimeout(() => {
                document.getElementById('loading').classList.add('hide');
                setTimeout(() => startFireworks(), 300);
            }, 1200);
        });

        // é£˜åŠ¨ç”»å…ƒç´  - ç§»åŠ¨ç«¯ä¼˜åŒ–
        function createFloatingElements() {
            const container = document.getElementById('floatingElements');
            const elements = ['âœ¨', 'â­', 'ğŸˆ', 'ğŸ‰', 'ğŸ’«', 'ğŸŒŸ'];
            const isMobileDevice = window.innerWidth < 768;
            // ä½æ€§èƒ½è®¾å¤‡è¿›ä¸€æ­¥å‡å°‘æˆ–ç¦ç”¨
            const count = isLowPerformance ? 0 : (isMobileDevice ? 3 : 15);
            
            if (count === 0) return; // ä½æ€§èƒ½è®¾å¤‡å®Œå…¨ç¦ç”¨
            
            for (let i = 0; i < count; i++) {
                const element = document.createElement('div');
                const isStar = Math.random() > 0.5;
                element.className = isStar ? 'star' : (Math.random() > 0.7 ? 'confetti large' : 'confetti');
                element.textContent = elements[Math.floor(Math.random() * elements.length)];
                element.style.left = Math.random() * 100 + '%';
                element.style.top = Math.random() * 100 + '%';
                element.style.animationDelay = Math.random() * 3 + 's';
                element.style.color = ['#ff00ff', '#8b00ff', '#00ffff', '#ff1493'][Math.floor(Math.random() * 4)];
                container.appendChild(element);
            }
        }
        createFloatingElements();

        // ç¥ç¦è¯­
        let currentBlessingIndex = -1;
        function getRandomBlessing() {
            let newIndex;
            do {
                newIndex = Math.floor(Math.random() * blessings.length);
            } while (newIndex === currentBlessingIndex && blessings.length > 1);
            currentBlessingIndex = newIndex;
            return blessings[newIndex];
        }

        function showBlessing() {
            const blessingText = document.getElementById('blessingText');
            const newBlessing = getRandomBlessing();
            
            blessingText.style.transition = 'opacity 0.2s, transform 0.2s';
            blessingText.style.opacity = '0';
            blessingText.style.transform = 'translate3d(0, -10px, 0)';
            
            setTimeout(() => {
                blessingText.textContent = newBlessing;
                blessingText.style.transform = 'translate3d(0, 5px, 0)';
                
                setTimeout(() => {
                    blessingText.style.opacity = '1';
                    blessingText.style.transform = 'translate3d(0, 0, 0)';
                }, 10);
            }, 200);
        }

        document.getElementById('changeBlessingBtn').addEventListener('click', () => {
            showBlessing();
            const startX = window.innerWidth / 2;
            const startY = window.innerHeight - 20;
            const targetX = window.innerWidth / 2;
            const targetY = window.innerHeight / 2;
            createFirework(startX, startY, targetX, targetY);
        });

        // éŸ³ä¹æ§åˆ¶
        let bgMusic = null;
        let isMusicPlaying = false;
        const musicControl = document.getElementById('musicControl');
        const musicVisualizer = document.getElementById('musicVisualizer');

        musicControl.addEventListener('click', () => {
            if (!bgMusic) {
                bgMusic = new Audio();
                bgMusic.loop = true;
                bgMusic.volume = 0.3;
            }

            if (isMusicPlaying) {
                bgMusic.pause();
                musicControl.textContent = 'ğŸµ èƒŒæ™¯éŸ³ä¹';
                musicVisualizer.classList.remove('active');
                isMusicPlaying = false;
            } else {
                bgMusic.play().catch(() => {
                    alert('è¯·ç‚¹å‡»é¡µé¢ä»»æ„ä½ç½®åï¼Œå†ç‚¹å‡»éŸ³ä¹æŒ‰é’®æ’­æ”¾');
                });
                musicControl.textContent = 'â¸ï¸ æš‚åœéŸ³ä¹';
                musicVisualizer.classList.add('active');
                isMusicPlaying = true;
            }
        });

        // å¹èœ¡çƒ›
        const flame = document.getElementById('flame');
        const particles = document.getElementById('particles');
        let isBlown = false;

        flame.addEventListener('click', () => {
            if (isBlown) return;
            isBlown = true;

            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                oscillator.type = 'sawtooth';
                oscillator.frequency.setValueAtTime(80, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(40, audioContext.currentTime + 1);
                gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 1);
            } catch (e) {}

            flame.classList.add('blown');
            setTimeout(() => {
                document.getElementById('candle').classList.add('has-burnt');
            }, 500);

            const particleColors = [
                { light: '#ffd93d', main: '#ffa500' },
                { light: '#ffb347', main: '#ff8c00' },
                { light: '#ffd700', main: '#ffa500' },
                { light: '#ffeb3b', main: '#ffc107' }
            ];

            for (let i = 0; i < 10; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                const angle = (Math.PI * 2 * i) / 10;
                const distance = 60 + Math.random() * 50;
                const velocity = 1 + Math.random() * 0.5;
                const color = particleColors[Math.floor(Math.random() * particleColors.length)];
                
                const size = 3 + Math.random() * 1; // ç»Ÿä¸€3-4px
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                particle.style.setProperty('--tx', Math.cos(angle) * distance * velocity + 'px');
                particle.style.setProperty('--ty', Math.sin(angle) * distance * velocity + 'px');
                particle.style.setProperty('--rotation', (Math.random() * 720 - 360) + 'deg');
                particle.style.setProperty('--particle-color', color.main);
                particle.style.setProperty('--particle-color-light', color.light);
                
                particles.appendChild(particle);
                setTimeout(() => particle.remove(), 600);
            }
        });

        // ç”Ÿæ—¥ç­¾
        const cardBtn = document.getElementById('cardBtn');
        const cardModal = document.getElementById('cardModal');
        const cardText = document.getElementById('cardText');
        const closeCard = document.getElementById('closeCard');

        cardBtn.addEventListener('click', () => {
            const randomCard = cardMessages[Math.floor(Math.random() * cardMessages.length)];
            cardText.textContent = randomCard;
            cardModal.classList.add('show');
            const startX = window.innerWidth / 2;
            const startY = window.innerHeight - 20;
            const targetX = window.innerWidth / 2;
            const targetY = window.innerHeight / 2;
            createFirework(startX, startY, targetX, targetY);
        });

        closeCard.addEventListener('click', () => {
            cardModal.classList.remove('show');
        });

        cardModal.addEventListener('click', (e) => {
            if (e.target === cardModal) {
                cardModal.classList.remove('show');
            }
        });

        // ç¥ç¦å¢™
        const wallInput = document.getElementById('wallInput');
        const wallSubmit = document.getElementById('wallSubmit');
        const wallMessages = document.getElementById('wallMessages');
        const blessingCount = document.getElementById('blessingCount');

        function toggleLike(btn) {
            const countSpan = btn.querySelector('.like-count');
            const isLiked = btn.classList.contains('liked');
            if (isLiked) {
                btn.classList.remove('liked');
                countSpan.textContent = parseInt(countSpan.textContent) - 1;
            } else {
                btn.classList.add('liked');
                countSpan.textContent = parseInt(countSpan.textContent) + 1;
            }
        }

        wallSubmit.addEventListener('click', () => {
            const message = wallInput.value.trim();
            if (message) {
                wallSubmit.classList.add('loading');
                
                setTimeout(() => {
                    const messageDiv = document.createElement('div');
                    messageDiv.className = 'wall-message';
                    const randomLikeCount = getRandomLikeCount();
                    messageDiv.innerHTML = `
                        <div>${message}</div>
                        <div class="wall-message-actions">
                            <button class="like-btn" onclick="toggleLike(this)">â¤ï¸ <span class="like-count">${randomLikeCount}</span></button>
                            <button class="reply-btn">ğŸ’¬ å›å¤</button>
                        </div>
                    `;
                    
                    wallMessages.insertBefore(messageDiv, wallMessages.firstChild);
                    wallInput.value = '';
                    wallSubmit.classList.remove('loading');
                    blessingCount.textContent = parseInt(blessingCount.textContent) + 1;
                    // åªæ»šåŠ¨ç¥ç¦å¢™å†…éƒ¨ï¼Œä¸å½±å“æ•´ä¸ªé¡µé¢
                    requestAnimationFrame(() => {
                        wallMessages.scrollTop = 0;
                    });
                }, 800);
            }
        });

        wallInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                wallSubmit.click();
            }
        });

        // è¿”å›é¡¶éƒ¨
        const backToTop = document.getElementById('backToTop');
        let scrollTimeout;
        window.addEventListener('scroll', () => {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                if (window.scrollY > 500) {
                    backToTop.classList.add('show');
                } else {
                    backToTop.classList.remove('show');
                }
            }, 10);
        }, { passive: true });
        
        backToTop.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // åŒå‡»å±å¹•ç‰¹æ•ˆ - ä»…æ¡Œé¢ç«¯
        if (window.matchMedia('(hover: hover) and (pointer: fine)').matches) {
            let lastClickTime = 0;
            document.addEventListener('click', (e) => {
                if (e.target.tagName === 'BUTTON' || e.target.tagName === 'INPUT') return;
                
                const now = Date.now();
                if (now - lastClickTime < 300) {
                    // åŒå‡»è§¦å‘
                    for (let i = 0; i < 10; i++) {
                        setTimeout(() => {
                            const startX = e.clientX + (Math.random() - 0.5) * 100;
                            const startY = window.innerHeight - 20;
                            const targetX = e.clientX + (Math.random() - 0.5) * 200;
                            const targetY = e.clientY + (Math.random() - 0.5) * 200;
                            createFirework(startX, startY, targetX, targetY);
                        }, i * 50);
                    }
                }
                lastClickTime = now;
            });
        }

        // æ»‘åŠ¨æ‰‹åŠ¿è§£é”ç¥ç¦
        let touchStartY = 0;
        let touchEndY = 0;
        document.addEventListener('touchstart', (e) => {
            touchStartY = e.changedTouches[0].screenY;
        });
        document.addEventListener('touchend', (e) => {
            touchEndY = e.changedTouches[0].screenY;
            const swipeDistance = touchStartY - touchEndY;
            if (Math.abs(swipeDistance) > 100) {
                showBlessing();
                const startX = window.innerWidth / 2;
                const startY = window.innerHeight - 20;
                const targetX = window.innerWidth / 2;
                const targetY = window.innerHeight / 2;
                createFirework(startX, startY, targetX, targetY);
            }
        });

        // æ‘‡ä¸€æ‘‡åˆ‡æ¢ä¸»é¢˜ - ä¼˜åŒ–é˜ˆå€¼
        let lastShakeTime = 0;
        if (window.DeviceMotionEvent) {
            window.addEventListener('devicemotion', (e) => {
                const acceleration = e.accelerationIncludingGravity;
                if (!acceleration) return;
                
                const shake = Math.abs(acceleration.x) + Math.abs(acceleration.y) + Math.abs(acceleration.z);
                const now = Date.now();
                
                // æé«˜é˜ˆå€¼ï¼Œé¿å…è¯¯è§¦å‘
                if (shake > 50 && now - lastShakeTime > 3000) {
                    lastShakeTime = now;
                    themeToggle.click();
                    const startX = window.innerWidth / 2;
                    const startY = window.innerHeight - 20;
                    const targetX = window.innerWidth / 2;
                    const targetY = window.innerHeight / 2;
                    createFirework(startX, startY, targetX, targetY);
                }
            });
        }

        // ç²’å­æ‹–å°¾æ•ˆæœ - ä»…æ¡Œé¢ç«¯
        if (window.matchMedia('(hover: hover) and (pointer: fine)').matches) {
            let lastTrailTime = 0;
            document.addEventListener('mousemove', (e) => {
                const now = Date.now();
                if (now - lastTrailTime < 50) return;
                lastTrailTime = now;

                const particle = document.createElement('div');
                particle.className = 'trail-particle';
                particle.style.left = e.clientX + 'px';
                particle.style.top = e.clientY + 'px';
                particle.textContent = ['âœ¨', 'ğŸ’«', 'ğŸŒŸ'][Math.floor(Math.random() * 3)];
                particle.style.color = ['#ff00ff', '#8b00ff', '#00ffff', '#ff1493'][Math.floor(Math.random() * 4)];
                document.body.appendChild(particle);
                setTimeout(() => particle.remove(), 800);
            });
        }

        // æ»šåŠ¨è§¦å‘åŠ¨ç”»
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, observerOptions);

        // è§‚å¯Ÿéœ€è¦åŠ¨ç”»çš„å…ƒç´ 
        document.querySelectorAll('.blessing-section, .wall-section, .interactive-section').forEach(el => {
            observer.observe(el);
        });

        // é˜²æ­¢ç§»åŠ¨ç«¯æ»‘åˆ°åº•éƒ¨åè‡ªåŠ¨å›å¼¹
        if (isMobile) {
            let lastScrollTop = 0;
            let scrollTimeout;
            
            window.addEventListener('scroll', () => {
                clearTimeout(scrollTimeout);
                scrollTimeout = setTimeout(() => {
                    const currentScrollTop = window.pageYOffset || document.documentElement.scrollTop;
                    const scrollHeight = document.documentElement.scrollHeight;
                    const clientHeight = document.documentElement.clientHeight;
                    
                    // å¦‚æœå·²ç»æ»‘åˆ°åº•éƒ¨ï¼Œä¸”æ£€æµ‹åˆ°å‘ä¸Šæ»šåŠ¨ï¼Œé˜»æ­¢å›å¼¹
                    if (currentScrollTop + clientHeight >= scrollHeight - 5) {
                        if (currentScrollTop < lastScrollTop) {
                            // ä¿æŒåœ¨åº•éƒ¨ä½ç½®
                            window.scrollTo({
                                top: scrollHeight - clientHeight,
                                behavior: 'auto'
                            });
                        }
                    }
                    
                    lastScrollTop = currentScrollTop;
                }, 50);
            }, { passive: true });
        }

        // è·å–åŒ—äº¬æ—¶é—´
        function getBeijingTime() {
            try {
                const now = new Date();
                // è·å–UTCæ—¶é—´
                const utc = now.getTime() + (now.getTimezoneOffset() * 60000);
                // è½¬æ¢ä¸ºåŒ—äº¬æ—¶é—´ï¼ˆUTC+8ï¼‰
                const beijingTime = new Date(utc + (8 * 3600000));
                return beijingTime;
            } catch (e) {
                console.error('è·å–åŒ—äº¬æ—¶é—´å¤±è´¥:', e);
                return new Date();
            }
        }

        // æ›´æ–°æ—¥æœŸæ˜¾ç¤º
        function updateDateDisplay() {
            try {
                const dateDisplay = document.getElementById('dateDisplay');
                if (!dateDisplay) return;
                
                const beijingTime = getBeijingTime();
                const month = beijingTime.getMonth() + 1;
                const date = beijingTime.getDate();
                dateDisplay.textContent = `ä»Šå¤©æ˜¯${month}æœˆ${date}æ—¥ âœ¨`;
            } catch (e) {
                console.error('æ—¥æœŸæ›´æ–°å¤±è´¥:', e);
                const dateDisplay = document.getElementById('dateDisplay');
                if (dateDisplay) {
                    dateDisplay.textContent = 'ä»Šå¤©æ˜¯12æœˆ8æ—¥ âœ¨';
                }
            }
        }

        // ç”Ÿæˆéšæœºç‚¹èµæ•°ï¼ˆ200-500ï¼‰
        function getRandomLikeCount() {
            return Math.floor(Math.random() * (500 - 200 + 1)) + 200;
        }

        // åˆå§‹åŒ–æ‰€æœ‰ç‚¹èµæ•°
        function initLikeCounts() {
            try {
                const likeCounts = document.querySelectorAll('.like-count');
                likeCounts.forEach(countSpan => {
                    if (!countSpan.textContent || countSpan.textContent.trim() === '' || countSpan.textContent === '0') {
                        countSpan.textContent = getRandomLikeCount();
                    }
                });
            } catch (e) {
                console.error('ç‚¹èµæ•°åˆå§‹åŒ–å¤±è´¥:', e);
            }
        }

        // åˆå§‹åŒ–
        try {
            updateDateDisplay();
            // æ¯ç§’æ›´æ–°ä¸€æ¬¡æ—¥æœŸï¼ˆé˜²æ­¢è·¨å¤©ï¼‰
            setInterval(updateDateDisplay, 1000);
            // åˆå§‹åŒ–ç‚¹èµæ•°
            setTimeout(() => {
                initLikeCounts();
            }, 100);
            showBlessing();
        } catch (e) {
            console.error('åˆå§‹åŒ–å¤±è´¥:', e);
            showBlessing();
        }
    </script>
</body>
</html>

